import{J as h,e as n,l as y,x as s}from"./index-BOz7yRlp.js";const C=h("cartStore",()=>{const r=n(!1),u=n({}),i=n(""),e=n({loadingItem:""}),d=y(()=>u.value.carts?u.value.carts.reduce((a,t)=>a+t.qty,0):0),c=async()=>{try{r.value=!0;const t=await s.get("https://vue3-course-api.hexschool.io/api/cart-yu2513/cart");r.value=!1,u.value=t.data.data}catch(a){console.error("Error during get cart:",a)}};async function l(a,t=1){try{e.value.loadingItem=a,r.value=!0;const o={product_id:a,qty:t},v=await s.post("https://vue3-course-api.hexschool.io/api/cart-yu2513/cart",{data:o});return r.value=!1,e.value.loadingItem="",c(),v.data}catch(o){throw console.error("Error during add to cart:",o),r.value=!1,e.value.loadingItem="",o}}return{cart:u,isLoading:r,status:e,cartTotal:d,coupon_code:i,addToCart:l,updateCart:async a=>{try{e.value.loadingItem=a.id,r.value=!0;const t={product_id:a.product_id,qty:a.qty},o=`https://vue3-course-api.hexschool.io/api/cart-yu2513/cart/${a.id}`,p=await s.put(o,{data:t});r.value=!1,e.value.loadingItem="",c()}catch(t){console.error("Error during update cart:",t)}},getCart:c,removeFromCart:async a=>{try{r.value=!0;const t=`https://vue3-course-api.hexschool.io/api/cart-yu2513/cart/${a.id}`,o=await s.delete(t);r.value=!1,c()}catch(t){console.error("Error during remove from cart:",t)}},addCouponCode:async()=>{try{r.value=!0;const a={code:i.value},o=await s.post("https://vue3-course-api.hexschool.io/api/cart-yu2513/coupon",{data:a});r.value=!1,c(),countStore.pushMessageState(o,"套用優惠券")}catch(a){console.error("Error during add coupon code:",a)}}}});export{C as u};
